<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Guard Model Evaluation Against Information Reuse — borg_guard • BORG</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Guard Model Evaluation Against Information Reuse — borg_guard"><meta name="description" content="borg_guard() wraps an evaluation workflow and enforces valid data handling.
It intercepts operations that would leak information from test to training
data and either blocks them (hard violations) or rewrites them (soft violations)."><meta property="og:description" content="borg_guard() wraps an evaluation workflow and enforces valid data handling.
It intercepts operations that would leak information from test to training
data and either blocks them (hard violations) or rewrites them (soft violations)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BORG</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/quickstart.html">Get Started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/quickstart.html">Quick Start</a></li>
    <li><a class="dropdown-item" href="../articles/risk-taxonomy.html">Risk Taxonomy</a></li>
    <li><a class="dropdown-item" href="../articles/frameworks.html">Framework Integration</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gcol33/BORG" aria-label="GitHub"><span class="fa fab fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Guard Model Evaluation Against Information Reuse</h1>
      <small class="dont-index">Source: <a href="https://github.com/gcol33/BORG/blob/HEAD/R/borg_guard.R" class="external-link"><code>R/borg_guard.R</code></a></small>
      <div class="d-none name"><code>borg_guard.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>borg_guard()</code> wraps an evaluation workflow and enforces valid data handling.
It intercepts operations that would leak information from test to training
data and either blocks them (hard violations) or rewrites them (soft violations).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">borg_guard</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">train_idx</span>,</span>
<span>  <span class="va">test_idx</span>,</span>
<span>  mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"strict"</span>, <span class="st">"warn"</span>, <span class="st">"rewrite"</span><span class="op">)</span>,</span>
<span>  temporal_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  spatial_cols <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group_col <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data.frame containing the full dataset.</p></dd>


<dt id="arg-train-idx">train_idx<a class="anchor" aria-label="anchor" href="#arg-train-idx"></a></dt>
<dd><p>Integer vector of training row indices.</p></dd>


<dt id="arg-test-idx">test_idx<a class="anchor" aria-label="anchor" href="#arg-test-idx"></a></dt>
<dd><p>Integer vector of test row indices.</p></dd>


<dt id="arg-mode">mode<a class="anchor" aria-label="anchor" href="#arg-mode"></a></dt>
<dd><p>Character string specifying enforcement mode:</p><ul><li><p><code>"strict"</code>: Block all violations, refuse to proceed</p></li>
<li><p><code>"warn"</code>: Warn on violations but continue</p></li>
<li><p><code>"rewrite"</code>: Automatically fix violations where possible</p></li>
</ul></dd>


<dt id="arg-temporal-col">temporal_col<a class="anchor" aria-label="anchor" href="#arg-temporal-col"></a></dt>
<dd><p>Optional character string naming a timestamp column.
If provided, enables temporal ordering validation.</p></dd>


<dt id="arg-spatial-cols">spatial_cols<a class="anchor" aria-label="anchor" href="#arg-spatial-cols"></a></dt>
<dd><p>Optional character vector naming coordinate columns
(e.g., <code>c("longitude", "latitude")</code>). If provided, enables spatial
autocorrelation checks.</p></dd>


<dt id="arg-group-col">group_col<a class="anchor" aria-label="anchor" href="#arg-group-col"></a></dt>
<dd><p>Optional character string naming a grouping column.
If provided, enables group-level isolation checks.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>borg_context</code> object that can be used to wrap preprocessing
and evaluation calls. This object tracks all operations and validates them
against the train/test split.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>borg_guard()</code> creates a guarded context for model evaluation. Within this
context, BORG:</p>
<ol><li><p>Validates the initial train/test split</p></li>
<li><p>Monitors preprocessing operations for data leakage</p></li>
<li><p>Enforces temporal ordering (if <code>temporal_col</code> specified)</p></li>
<li><p>Validates spatial block separation (if <code>spatial_cols</code> specified)</p></li>
<li><p>Ensures group isolation (if <code>group_col</code> specified)</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="enforcement-modes">Enforcement Modes<a class="anchor" aria-label="anchor" href="#enforcement-modes"></a></h2>


<dl><dt>strict</dt>
<dd><p>Most conservative. Any detected violation causes an immediate
error. Use for production pipelines where validity is critical.</p></dd>

<dt>warn</dt>
<dd><p>Permissive mode. Violations generate warnings but evaluation
proceeds. Use for exploratory analysis or legacy code auditing.</p></dd>

<dt>rewrite</dt>
<dd><p>Automatic correction mode. BORG attempts to fix violations
(e.g., refitting preprocessing on train-only). Use when migrating
existing pipelines.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="borg_inspect.html">borg_inspect</a></code> for object-level inspection,
<code><a href="borg_validate.html">borg_validate</a></code> for post-hoc workflow validation.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># The canonical failure: preprocessing before splitting</span></span>
<span><span class="co"># This workflow produces inflated performance estimates:</span></span>
<span><span class="co">#</span></span>
<span><span class="co">#   data_scaled &lt;- scale(full_data)</span></span>
<span><span class="co">#   train &lt;- data_scaled[1:800, ]</span></span>
<span><span class="co">#   test &lt;- data_scaled[801:1000, ]</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># BORG blocks this pattern.</span></span>
<span></span>
<span><span class="co"># Valid split (no overlap)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ctx</span> <span class="op">&lt;-</span> <span class="fu">borg_guard</span><span class="op">(</span><span class="va">data</span>, train_idx <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">70</span>, test_idx <span class="op">=</span> <span class="fl">71</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ctx</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Invalid split (overlap) - errors immediately</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span>
<span><span class="va">ctx</span> <span class="op">&lt;-</span> <span class="fu">borg_guard</span><span class="op">(</span><span class="va">data</span>, train_idx <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">60</span>, test_idx <span class="op">=</span> <span class="fl">50</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="co"># Error: BORG HARD VIOLATION: train_idx and test_idx overlap</span></span>
<span><span class="op">}</span> <span class="co"># }</span></span>
<span></span>
<span><span class="co"># Grouped data - ensures no group appears in both splits</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">patient</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">ctx</span> <span class="op">&lt;-</span> <span class="fu">borg_guard</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  train_idx <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">50</span>,</span>
<span>  test_idx <span class="op">=</span> <span class="fl">51</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>  group_col <span class="op">=</span> <span class="st">"patient"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Temporal data - validates chronological ordering</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html" class="external-link">seq.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2020-01-01"</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"day"</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">ctx</span> <span class="op">&lt;-</span> <span class="fu">borg_guard</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  train_idx <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">70</span>,</span>
<span>  test_idx <span class="op">=</span> <span class="fl">71</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>  temporal_col <span class="op">=</span> <span class="st">"date"</span></span>
<span><span class="op">)</span></span>
<span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/gcol33" class="external-link">Gilles Colling</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

