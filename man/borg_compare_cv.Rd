% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/borg_compare.R
\name{borg_compare_cv}
\alias{borg_compare_cv}
\title{Compare Random vs Blocked Cross-Validation}
\usage{
borg_compare_cv(
  data,
  formula,
  model_fn = NULL,
  predict_fn = NULL,
  metric = NULL,
  diagnosis = NULL,
  coords = NULL,
  time = NULL,
  groups = NULL,
  target = NULL,
  v = 5,
  repeats = 10,
  seed = NULL,
  verbose = TRUE
)
}
\arguments{
\item{data}{A data frame containing predictors and response.}

\item{formula}{A formula specifying the model (e.g., \code{y ~ .}).}

\item{model_fn}{A function that fits a model. Should accept \code{formula} and
\code{data} arguments and return a fitted model with a \code{predict} method.
Default uses \code{lm}.}

\item{predict_fn}{A function to generate predictions. Should accept \code{model}
and \code{newdata} arguments. Default uses \code{predict}.}

\item{metric}{A character string specifying the metric to compute. One of
\code{"rmse"}, \code{"mae"}, \code{"rsq"}, \code{"auc"}, \code{"accuracy"}.
Default: \code{"rmse"} for regression, \code{"accuracy"} for classification.}

\item{diagnosis}{A \code{BorgDiagnosis} object. If NULL, will be computed
automatically using the provided structure hints.}

\item{coords}{Character vector of length 2 specifying coordinate column names.}

\item{time}{Character string specifying the time column name.}

\item{groups}{Character string specifying the grouping column name.}

\item{target}{Character string specifying the response variable name. If NULL,
extracted from formula.}

\item{v}{Integer. Number of CV folds. Default: 5.}

\item{repeats}{Integer. Number of times to repeat CV. Default: 10 for stable
estimates.}

\item{seed}{Integer. Random seed for reproducibility.}

\item{verbose}{Logical. Print progress messages. Default: TRUE.}
}
\value{
A \code{borg_comparison} object (S3 class) containing:
\describe{
\item{random_cv}{Data frame of metrics from random CV (one row per repeat)}
\item{blocked_cv}{Data frame of metrics from blocked CV (one row per repeat)}
\item{summary}{Summary statistics comparing the two approaches}
\item{inflation}{Estimated metric inflation from using random CV}
\item{diagnosis}{The BorgDiagnosis object used}
\item{p_value}{P-value from paired t-test comparing approaches}
}
}
\description{
Runs both random and blocked cross-validation on the same data and model,
providing empirical evidence of metric inflation from ignoring data dependencies.
}
\details{
This function provides the "smoking gun" evidence for reviewers. It runs
cross-validation twice on the same data:
\enumerate{
\item \strong{Random CV}: Standard k-fold CV ignoring data structure
\item \strong{Blocked CV}: Structure-aware CV based on BORG diagnosis
}

The difference in metrics demonstrates empirically how much random CV
inflates performance estimates when data dependencies exist.

For stable estimates, the comparison is repeated multiple times (default: 10)
and a paired t-test assesses whether the difference is statistically significant.
}
\examples{
# Spatial data example
set.seed(42)
n <- 200
spatial_data <- data.frame(
  x = runif(n, 0, 100),
  y = runif(n, 0, 100)
)
# Create spatially autocorrelated response
spatial_data$response <- spatial_data$x * 0.5 + rnorm(n, sd = 5)

# Compare CV approaches
comparison <- borg_compare_cv(
  spatial_data,
  formula = response ~ x + y,
  coords = c("x", "y"),
  repeats = 5  # Use more repeats in practice
)

print(comparison)
plot(comparison)

}
\seealso{
\code{\link{borg_diagnose}} for dependency detection,
\code{\link{borg_cv}} for generating blocked CV folds.
}
